from Crypto.Cipher import ARC4
import lzma


with open("encrypted_rdata_1005D2F8", "rb") as enc_datafile:
	ciphertext = enc_datafile.read()
	
key = bytearray(b"\x23\xb6\xb4\x67\xa3\x03\x26\x02\xb6\x87\x5c\x51\xce\x69\x39\x7d\x58\xf3\xc0\xba\xfb\xbc\x63\xbd\xef\x0a\x4c\x41\xa9\xb8\x98\x71")
rc4 = ARC4.new(key)
plaintext = rc4.decrypt(ciphertext)

props = lzma._decode_filter_properties(lzma.FILTER_LZMA1, plaintext[0:5])
decompressor = lzma.LZMADecompressor(lzma.FORMAT_RAW, filters=[props])

with open("decrypted_rdata_1005D2F8", "wb") as dec_datafile:
    dec_datafile.write(decompressor.decompress(plaintext[5:]))

